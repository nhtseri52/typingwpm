<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HỆ THỐNG GÕ BÀN PHÍM TIẾNG VIỆT CHUYÊN NGHIỆP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- CSS TOOLKIT & VARIABLES --- */
        :root {
            --primary-dark: #2c3e50;
            --accent-blue: #3498db;
            --success-green: #2ecc71;
            --error-red: #e74c3c;
            --bg-light: #f4f7f9;
            --text-main: #333;
            --sidebar-width: 280px;
            --transition: all 0.3s ease;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }

        body {
            background-color: var(--bg-light);
            color: var(--text-main);
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* --- SIDEBAR NAVIGATION --- */
        .sidebar {
            width: var(--sidebar-width);
            background: #fff;
            height: 100%;
            display: flex;
            flex-direction: column;
            border-right: 1px solid #dee2e6;
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
            z-index: 100;
        }

        .sidebar-header {
            padding: 40px 20px;
            text-align: center;
            border-bottom: 1px solid #f1f1f1;
        }

        .sidebar-header h1 {
            font-size: 22px;
            font-weight: 900;
            color: var(--accent-blue);
            text-transform: uppercase;
            letter-spacing: 1px;
            line-height: 1.3;
        }

        .nav-list {
            flex: 1;
            padding: 20px 10px;
            overflow-y: auto;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 14px 20px;
            color: var(--primary-dark);
            text-decoration: none;
            font-weight: 600;
            border-radius: 10px;
            margin-bottom: 8px;
            transition: var(--transition);
            cursor: pointer;
        }

        .nav-link:hover {
            background: #f0f4f8;
            transform: translateX(5px);
        }

        .nav-link.active {
            background: var(--accent-blue);
            color: #fff;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid #f1f1f1;
        }

        .btn-logout {
            width: 100%;
            padding: 12px;
            background: #fff0f0;
            color: var(--error-red);
            border: 1px solid #ffdada;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-logout:hover { background: var(--error-red); color: #fff; }

        /* --- MAIN CONTENT AREA --- */
        .content-area {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .view-container {
            width: 100%;
            max-width: 1000px;
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .view-container.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- BANNER DESIGN --- */
        .hero-banner {
            width: 100%;
            height: 200px;
            border-radius: 20px;
            margin-bottom: 30px;
            background-size: cover;
            background-position: center;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 30px;
            color: #fff;
            position: relative;
            overflow: hidden;
        }

        .hero-banner::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
        }

        .hero-banner h2 { position: relative; font-size: 32px; font-weight: 800; z-index: 1; }

        /* --- TYPING ENGINE UI --- */
        .typing-wrapper {
            background: #fff;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            position: relative;
        }

        .word-display-box {
            background: #f8f9fa;
            border: 1px solid #eee;
            border-radius: 12px;
            padding: 20px;
            height: 120px;
            overflow: hidden;
            position: relative;
            font-size: 30px;
            line-height: 55px;
            margin-bottom: 25px;
            user-select: none;
        }

        .word-scroller {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            transition: top 0.25s ease-out;
        }

        .word-scroller span {
            display: inline-block;
            margin-right: 18px;
            padding: 0 10px;
            border-radius: 6px;
            color: #666;
        }

        .word-scroller span.current { background: #e2e8f0; color: #000; font-weight: 600; }
        .word-scroller span.correct { color: var(--success-green); }
        .word-scroller span.wrong { color: var(--error-red); background: #fff0f0; }

        .input-panel {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .typing-input {
            flex: 1;
            height: 65px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 0 25px;
            font-size: 26px;
            outline: none;
            transition: border-color 0.2s;
        }

        .typing-input:focus { border-color: var(--accent-blue); }

        .stat-timer {
            width: 120px;
            height: 65px;
            background: var(--primary-dark);
            color: #fff;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: 800;
        }

        .btn-refresh {
            width: 65px;
            height: 65px;
            background: var(--accent-blue);
            color: #fff;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 24px;
            transition: var(--transition);
        }

        .btn-refresh:hover { transform: rotate(180deg); background: #2980b9; }

        /* --- RESULT MODAL --- */
        .result-overlay {
            position: absolute;
            inset: 0;
            background: rgba(255,255,255,0.98);
            z-index: 50;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 15px;
            text-align: center;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin: 40px 0;
            width: 80%;
        }

        .res-box {
            padding: 25px;
            background: var(--bg-light);
            border-radius: 15px;
            border: 1px solid #eee;
        }

        .res-label { font-size: 14px; text-transform: uppercase; color: #777; margin-bottom: 10px; font-weight: bold; }
        .res-value { font-size: 45px; font-weight: 900; color: var(--accent-blue); }

        /* --- COMMUNITY & TABLES --- */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .data-table th { background: #f8f9fa; padding: 20px; text-align: left; color: #666; font-size: 14px; }
        .data-table td { padding: 20px; border-top: 1px solid #f1f1f1; }
        .data-table tr:hover { background: #fafafa; }

        .comm-card {
            background: #fff;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 5px solid var(--accent-blue);
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
        }

        /* --- LOGIN SCREEN --- */
        .login-screen {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #2c3e50, #4ca1af);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .login-box {
            background: #fff;
            padding: 50px;
            border-radius: 20px;
            width: 450px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            text-align: center;
        }

        .login-box input {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
        }

        .btn-submit {
            width: 100%;
            padding: 15px;
            background: var(--accent-blue);
            color: #fff;
            border: none;
            border-radius: 10px;
            font-weight: 800;
            font-size: 18px;
            cursor: pointer;
        }

        /* --- SCROLLBAR --- */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #ccc; border-radius: 10px; }
    </style>
</head>
<body>

    <div id="login-screen" class="login-screen">
        <div class="login-box">
            <h1 style="color: var(--accent-blue); margin-bottom: 30px;">TYPING ELITE</h1>
            <input type="text" id="input-username" placeholder="Tên tài khoản">
            <input type="password" id="input-password" placeholder="Mật khẩu">
            <button class="btn-submit" onclick="TypingApp.auth()">BẮT ĐẦU LUYỆN TẬP</button>
            <p style="margin-top: 25px; color: #777; font-size: 13px;">
                Mặc định: <b>nhtseri</b> / <b>Locthinh1!</b>
            </p>
        </div>
    </div>

    <div class="sidebar">
        <div class="sidebar-header">
            <h1 id="logo-text">GÕ BÀN PHÍM<br>TIẾNG VIỆT</h1>
        </div>
        <div class="nav-list" id="nav-list">
            </div>
        <div class="sidebar-footer">
            <button class="btn-logout" onclick="TypingApp.logout()">
                <i class="fa-solid fa-power-off"></i> ĐĂNG XUẤT
            </button>
        </div>
    </div>

    <div class="content-area">
        
        <div id="view-home" class="view-container active">
            <div class="hero-banner" style="background-image: url('https://images.unsplash.com/photo-1512486130939-2c4f79935e4f?q=80&w=1000')">
                <h2>CHẾ ĐỘ LUYỆN TẬP</h2>
            </div>
            
            <div class="typing-wrapper">
                <div id="result-modal" class="result-overlay">
                    <h1 style="font-size: 40px; color: var(--primary-dark);">KẾT QUẢ CỦA BẠN</h1>
                    <div class="result-grid">
                        <div class="res-box">
                            <div class="res-label">Tốc độ (WPM)</div>
                            <div class="res-value" id="val-wpm">0</div>
                        </div>
                        <div class="res-box">
                            <div class="res-label">Chính xác</div>
                            <div class="res-value" id="val-acc">0%</div>
                        </div>
                        <div class="res-box">
                            <div class="res-label">Từ đúng</div>
                            <div class="res-value" id="val-ok" style="color: var(--success-green);">0</div>
                        </div>
                    </div>
                    <button class="btn-submit" style="width: 250px;" onclick="TypingApp.resetEngine()">LUYỆN TẬP LẠI</button>
                </div>

                <div class="word-display-box">
                    <div id="word-scroller" class="word-scroller"></div>
                </div>

                <div class="input-panel">
                    <input type="text" id="typing-input" class="typing-input" placeholder="Gõ từ tại đây..." autocomplete="off">
                    <div id="timer-box" class="stat-timer">1:00</div>
                    <button class="btn-refresh" onclick="TypingApp.resetEngine()">
                        <i class="fa-solid fa-rotate-right"></i>
                    </button>
                </div>
            </div>

            <div style="margin-top: 30px; display: flex; gap: 40px;">
                <div class="card-info">
                    <p style="color: #888; font-weight: bold; font-size: 13px;">KỶ LỤC CÁ NHÂN</p>
                    <p style="font-size: 24px; font-weight: 800;"><span id="best-wpm-ui">0</span> WPM</p>
                </div>
                <div class="card-info">
                    <p style="color: #888; font-weight: bold; font-size: 13px;">TỔNG TỪ ĐÃ GÕ</p>
                    <p style="font-size: 24px; font-weight: 800;"><span id="total-words-ui">0</span> TỪ</p>
                </div>
            </div>
        </div>

        <div id="view-comm" class="view-container">
            <div class="hero-banner" style="background-image: url('https://images.unsplash.com/photo-1522202176988-66273c2fd55f?q=80&w=1000')">
                <h2>VĂN BẢN CỘNG ĐỒNG</h2>
            </div>
            <div style="margin-bottom: 30px;">
                <button class="btn-submit" style="width: auto; padding: 12px 30px;" onclick="TypingApp.addNewPost()">
                    <i class="fa-solid fa-plus"></i> CHIA SẺ VĂN BẢN MỚI
                </button>
            </div>
            <div id="community-list"></div>
        </div>

        <div id="view-rank" class="view-container">
            <div class="hero-banner" style="background-image: url('https://images.unsplash.com/photo-1551818255-e6e10975bc17?q=80&w=1000')">
                <h2>TOP CAO THỦ</h2>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>HẠNG</th>
                        <th>NGƯỜI CHƠI</th>
                        <th>TỐC ĐỘ (WPM)</th>
                        <th>NGÀY THỰC HIỆN</th>
                    </tr>
                </thead>
                <tbody id="ranking-body"></tbody>
            </table>
        </div>

        <div id="view-profile" class="view-container">
            <div class="hero-banner" style="background-image: url('https://images.unsplash.com/photo-1499750310107-5fef28a66643?q=80&w=1000')">
                <h2>HỒ SƠ CỦA BẠN</h2>
            </div>
            <div id="profile-details" class="typing-wrapper" style="line-height: 2.5; font-size: 18px;"></div>
        </div>

    </div>

    <audio id="sound-click" src="https://www.soundjay.com/buttons/button-16.mp3"></audio>

    <script>
        /* --- KHO TỪ VỰNG TIẾNG VIỆT --- */
        const VI_DICTIONARY = "anh em gia đình trường học máy tính điện thoại bàn phím chuột màn hình lập trình thông minh chiến thắng nỗ lực kiên trì thành công hạnh phúc việt nam hà nội sài gòn du lịch biển nước ăn ngon vui vẻ tự tin sáng tạo lịch sử toán vật lý hóa học tiếng anh độc lập tự do tổ quốc bạn bè sinh nhật lễ hội xuân hạ thu đông vở viết kiến thức kỹ năng văn phòng chất lượng tài chính sức khỏe thể thao bóng đá gym phim ảnh mạng xã hội chụp hình nhà khách sạn cà phê trà sữa phở bún cơm trái cây cam táo bia rượu mưa nắng gió mây trời đất sông núi rừng cây hoa lá vàng bạc đồng sắt thép nhôm kính nhựa giấy bút mực thước cặp sách bàn ghế giường tủ bếp nồi chảo chén đĩa muỗng đũa khăn áo quần giày dép mũ nón ví tiền đồng hồ kính mát nhẫn dây chuyền vòng tay tai nghe loa pin sạc cáp wifi web app code game phim nhạc họa ca múa hát nhảy đàn sáo trống kèn vẽ tô màu tranh ảnh tượng đá gạch cát vôi xi măng sơn gỗ tre nứa lá cọ dừa chuối xoài ổi mận đào lê nho dâu bơ mít dứa khế chanh ớt tỏi hành gừng sả tiêu muối đường mì chính dầu mỡ thịt cá tôm cua ốc ếch lươn gà vịt ngỗng heo bò trâu dê cừu ngựa voi hổ báo sư tử gấu khỉ vượn nai hoẵng thỏ chuột mèo chó chim cá sâu bướm ong kiến gián muỗi ruồi nhện rắn rùa thằn lằn".split(" ");

        /* --- CORE APPLICATION LOGIC --- */
        const TypingApp = {
            user: null,
            words: [],
            currentIndex: 0,
            timeLeft: 60,
            isActive: false,
            timerInterval: null,
            correctWords: 0,
            wrongWords: 0,
            
            // 1. Khởi tạo ứng dụng
            init() {
                const session = localStorage.getItem('typing_elite_session');
                if (session) {
                    this.user = JSON.parse(session);
                    document.getElementById('login-screen').style.display = 'none';
                    this.renderNavigation();
                    this.resetEngine();
                }
            },

            // 2. Xác thực người dùng
            auth() {
                const u = document.getElementById('input-username').value.trim();
                const p = document.getElementById('input-password').value.trim();
                
                if (!u || !p) { alert("Vui lòng nhập đầy đủ!"); return; }

                // Logic Admin & User
                if (u === 'nhtseri' && p === 'Locthinh1!') {
                    this.user = { username: u, password: p, bestWPM: 0, totalWords: 0, isAdmin: true };
                } else {
                    let saved = localStorage.getItem('user_data_' + u);
                    if (saved) {
                        let parsed = JSON.parse(saved);
                        if (parsed.password !== p) { alert("Mật khẩu không chính xác!"); return; }
                        this.user = parsed;
                    } else {
                        this.user = { username: u, password: p, bestWPM: 0, totalWords: 0, isAdmin: false };
                        localStorage.setItem('user_data_' + u, JSON.stringify(this.user));
                    }
                }
                
                localStorage.setItem('typing_elite_session', JSON.stringify(this.user));
                location.reload();
            },

            // 3. Render Navigation Sidebar
            renderNavigation() {
                const menu = [
                    { id: 'home', label: 'Luyện tập', icon: 'fa-keyboard' },
                    { id: 'comm', label: 'Cộng đồng', icon: 'fa-users' },
                    { id: 'rank', label: 'Bảng xếp hạng', icon: 'fa-trophy' },
                    { id: 'profile', label: 'Hồ sơ cá nhân', icon: 'fa-circle-user' }
                ];

                const navHtml = menu.map(item => `
                    <div class="nav-link ${item.id === 'home' ? 'active' : ''}" id="nav-${item.id}" onclick="TypingApp.switchView('${item.id}')">
                        <i class="fa-solid ${item.icon}"></i> ${item.label}
                    </div>
                `).join('');
                
                document.getElementById('nav-list').innerHTML = navHtml;
            },

            // 4. Chuyển đổi View
            switchView(viewId) {
                document.querySelectorAll('.view-container').forEach(v => v.classList.remove('active'));
                document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
                
                document.getElementById('view-' + viewId).classList.add('active');
                document.getElementById('nav-' + viewId).classList.add('active');

                if (viewId === 'home') this.resetEngine();
                if (viewId === 'rank') this.renderRanking();
                if (viewId === 'comm') this.renderCommunity();
                if (viewId === 'profile') this.renderProfile();
            },

            // 5. Engine Luyện Tập (10FastFingers Style)
            resetEngine(customArray = null) {
                clearInterval(this.timerInterval);
                this.isActive = false;
                this.timeLeft = 60;
                this.currentIndex = 0;
                this.correctWords = 0;
                this.wrongWords = 0;

                document.getElementById('timer-box').innerText = "1:00";
                document.getElementById('typing-input').value = "";
                document.getElementById('typing-input').disabled = false;
                document.getElementById('result-modal').style.display = 'none';
                document.getElementById('best-wpm-ui').innerText = this.user.bestWPM || 0;
                document.getElementById('total-words-ui').innerText = this.user.totalWords || 0;

                // Tạo từ ngẫu nhiên hoặc dùng văn bản custom
                this.words = customArray || this.generateRandomWords(200);
                this.renderWords();
                document.getElementById('typing-input').focus();
            },

            generateRandomWords(count) {
                let res = [];
                for(let i=0; i<count; i++) {
                    res.push(VI_DICTIONARY[Math.floor(Math.random() * VI_DICTIONARY.length)]);
                }
                return res;
            },

            renderWords() {
                const scroller = document.getElementById('word-scroller');
                scroller.style.top = "20px";
                scroller.innerHTML = this.words.map((w, i) => `<span id="word-${i}">${w}</span>`).join('');
                document.getElementById('word-0').className = 'current';
            },

            handleTyping(e) {
                if (!this.isActive && e.target.value.length > 0) {
                    this.startTimer();
                }

                // Khi nhấn Space (Dấu cách)
                if (e.target.value.endsWith(" ")) {
                    const typed = e.target.value.trim().toLowerCase();
                    const target = this.words[this.currentIndex].toLowerCase();
                    const currentEl = document.getElementById(`word-${this.currentIndex}`);

                    if (typed === target) {
                        currentEl.className = 'correct';
                        this.correctWords++;
                    } else {
                        currentEl.className = 'wrong';
                        this.wrongWords++;
                    }

                    this.currentIndex++;
                    const nextEl = document.getElementById(`word-${this.currentIndex}`);
                    if (nextEl) {
                        nextEl.className = 'current';
                        // Cuộn dòng nếu từ hiện tại nằm ở hàng dưới
                        if (nextEl.offsetTop > 40) {
                            document.getElementById('word-scroller').style.top = (20 - nextEl.offsetTop) + "px";
                        }
                    }
                    e.target.value = "";
                }
            },

            startTimer() {
                this.isActive = true;
                this.timerInterval = setInterval(() => {
                    this.timeLeft--;
                    let sec = this.timeLeft;
                    document.getElementById('timer-box').innerText = `0:${sec < 10 ? '0'+sec : sec}`;
                    
                    if (this.timeLeft <= 0) {
                        this.finishTest();
                    }
                }, 1000);
            },

            finishTest() {
                clearInterval(this.timerInterval);
                document.getElementById('typing-input').disabled = true;
                
                const wpm = this.correctWords;
                const accuracy = Math.round((this.correctWords / (this.correctWords + this.wrongWords)) * 100) || 0;

                // Hiển thị kết quả
                document.getElementById('val-wpm').innerText = wpm;
                document.getElementById('val-acc').innerText = accuracy + "%";
                document.getElementById('val-ok').innerText = this.correctWords;
                document.getElementById('result-modal').style.display = 'flex';

                // Cập nhật Database cá nhân
                this.user.totalWords += this.correctWords;
                if (wpm > this.user.bestWPM) {
                    this.user.bestWPM = wpm;
                    this.updateGlobalRanking(wpm);
                }
                
                localStorage.setItem('user_data_' + this.user.username, JSON.stringify(this.user));
                localStorage.setItem('typing_elite_session', JSON.stringify(this.user));
            },

            // 6. Quản lý Ranking
            updateGlobalRanking(wpm) {
                let ranks = JSON.parse(localStorage.getItem('global_ranks') || "[]");
                let exist = ranks.findIndex(r => r.name === this.user.username);
                
                if (exist !== -1) {
                    if (wpm > ranks[exist].score) ranks[exist].score = wpm;
                } else {
                    ranks.push({ name: this.user.username, score: wpm, date: new Date().toLocaleDateString() });
                }

                ranks.sort((a, b) => b.score - a.score);
                localStorage.setItem('global_ranks', JSON.stringify(ranks.slice(0, 20)));
            },

            renderRanking() {
                const ranks = JSON.parse(localStorage.getItem('global_ranks') || "[]");
                const html = ranks.map((r, i) => `
                    <tr>
                        <td><b>#${i+1}</b></td>
                        <td>${r.name}</td>
                        <td style="color: var(--accent-blue); font-weight: 800;">${r.score} WPM</td>
                        <td>${r.date}</td>
                    </tr>
                `).join('');
                document.getElementById('ranking-body').innerHTML = html || "<tr><td colspan='4' align='center'>Chưa có cao thủ nào xuất hiện</td></tr>";
            },

            // 7. Cộng đồng văn bản
            renderCommunity() {
                const posts = JSON.parse(localStorage.getItem('comm_posts') || "[]");
                const html = posts.map((p, i) => `
                    <div class="comm-card">
                        <div>
                            <p style="font-size: 14px; color: #888;">Người đăng: <b>${p.author}</b></p>
                            <p style="font-size: 18px; font-weight: 600; margin-top: 5px;">${p.content.substring(0, 60)}...</p>
                        </div>
                        <button class="btn-refresh" style="font-size: 16px; width: auto; padding: 0 20px;" onclick="TypingApp.loadPost(${i})">
                            LUYỆN TẬP BÀI NÀY
                        </button>
                    </div>
                `).join('');
                document.getElementById('community-list').innerHTML = html || "<p align='center'>Chưa có bài viết nào</p>";
            },

            addNewPost() {
                const content = prompt("Hãy dán đoạn văn bản (Tiếng Việt) mà bro muốn chia sẻ:");
                if (content && content.trim().length > 10) {
                    let posts = JSON.parse(localStorage.getItem('comm_posts') || "[]");
                    posts.unshift({ author: this.user.username, content: content.trim() });
                    localStorage.setItem('comm_posts', JSON.stringify(posts));
                    this.renderCommunity();
                } else {
                    alert("Văn bản quá ngắn!");
                }
            },

            loadPost(index) {
                const posts = JSON.parse(localStorage.getItem('comm_posts'));
                const textArray = posts[index].content.split(/\s+/);
                this.switchView('home');
                this.resetEngine(textArray);
            },

            // 8. Hồ sơ
            renderProfile() {
                document.getElementById('profile-details').innerHTML = `
                    <p>Tài khoản: <b style="color: var(--accent-blue)">${this.user.username}</b></p>
                    <p>Mật khẩu: <b style="background: #333; color: #333; padding: 2px 10px; border-radius: 4px; cursor: pointer;" onclick="this.style.color='#fff'">${this.user.password}</b> <small>(Nhấn để hiện)</small></p>
                    <hr style="margin: 20px 0; border: none; border-top: 1px solid #eee;">
                    <p>Tốc độ cao nhất: <b>${this.user.bestWPM} WPM</b></p>
                    <p>Tổng từ đã gõ: <b>${this.user.totalWords} Từ</b></p>
                    <p>Phân hạng: <b>${this.user.bestWPM > 80 ? 'SIÊU CẤP' : (this.user.bestWPM > 50 ? 'CAO THỦ' : 'TẬP SỰ')}</b></p>
                `;
            },

            logout() {
                localStorage.removeItem('typing_elite_session');
                location.reload();
            }
        };

        // BẮT ĐẦU CHƯƠNG TRÌNH
        document.getElementById('typing-input').addEventListener('input', (e) => TypingApp.handleTyping(e));
        window.onload = () => TypingApp.init();

    </script>
</body>
</html>
